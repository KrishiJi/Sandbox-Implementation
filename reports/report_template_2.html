<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Malware Analysis Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 2rem;
            background-color: #f8f9fa;
        }
        .section-title {
            margin-top: 2rem;
            border-bottom: 2px solid #343a40;
            padding-bottom: 0.5rem;
        }
        pre {
            background-color: #212529;
            color: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            overflow-x: auto;
        }
        .risk-medium { color: orange; font-weight: bold; }
        .risk-high { color: red; font-weight: bold; }
        .risk-low { color: green; font-weight: bold; }
    </style>
</head>
<body>
    <h1 class="text-primary">ğŸ” Malware Analysis Report</h1>
    <hr>
    <div>
        <h4>ğŸ“‚ File: {{ file_name }}</h4>
        <p><strong>MD5:</strong> {{ md5 }}<br>
           <strong>SHA256:</strong> {{ sha256 }}<br>
           <strong>Size:</strong> {{ file_info.size }} bytes<br>
           <strong>Permissions:</strong> {{ file_info.permissions }}<br>
           <strong>Last Modified:</strong> {{ file_info.last_modified }}</p>
    </div>

    <h3 class="section-title">ğŸ“˜ Static Analysis</h3>
    <h5>ğŸ§¾ File Info</h5>
    <pre>{{ file_cmd }}</pre>
    <h5>ğŸ”¤ Strings (Top 20)</h5>
    <pre>{{ strings }}</pre>
    <h5>ğŸ“‘ ELF Header</h5>
    <pre>{{ readelf }}</pre>

    <h3 class="section-title">ğŸ’» Dynamic Analysis (System Calls)</h3>
    {% if syscall_log %}
        <pre>{{ syscall_log }}</pre>
    {% else %}
        <p>No system call data available. Dynamic analysis might have failed.</p>
    {% endif %}

    <h3 class="section-title">âš ï¸ Risk Evaluation</h3>
    <p><strong>Risk Score:</strong> {{ risk_score }}<br>
       <strong>Risk Level:</strong> <span class="risk-{{ risk_level|lower }}">{{ risk_level }}</span></p>

    <hr>
    <p class="text-muted">Generated by Linux Malware Sandbox</p>
</body>
</html>

